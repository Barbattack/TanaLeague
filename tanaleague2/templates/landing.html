{% extends "base.html" %}
{% block title %}TanaLeague - Home{% endblock %}
{% block description %}Classifiche e statistiche TCG de La Tana delle Pulci{% endblock %}

{% block content %}
<!-- HERO -->
<div class="text-center py-5 mb-3">
  <img src="{{ url_for('static', filename='logo.png') }}" alt="La Tana delle Pulci" style="max-width: 180px;" class="mb-3">
  <h1 class="display-4 fw-bold mb-2">TanaLeague</h1>
  <p class="lead text-muted">Il tuo punto di riferimento per classifiche e statistiche TCG</p>
</div>

<!-- TICKER - Stile leggero integrato -->
<div class="mb-5">
  <div class="ticker-container py-2 rounded-pill overflow-hidden position-relative">
    <div class="ticker-live-badge">
      <span class="badge bg-danger pulse-animation">â— LIVE</span>
    </div>
    <div class="ticker-content">
      <span class="ticker-text">
        {% if stats and stats.pulse and stats.pulse.kpi %}
        ğŸ® {{ stats.pulse.kpi.unique_players }} giocatori in competizione
        &nbsp;â€¢&nbsp;
        ğŸ† {{ stats.pulse.kpi.events_total }} tornei disputati
        &nbsp;â€¢&nbsp;
        {% endif %}
        âš”ï¸ 3 TCG: One Piece, PokÃ©mon, Riftbound
        &nbsp;â€¢&nbsp;
        ğŸ”¥ Classifiche sempre aggiornate!
        &nbsp;â€¢&nbsp;
        ğŸ‘€ Chi sarÃ  il prossimo campione?
        &nbsp;â€¢&nbsp;
      </span>
      <span class="ticker-text" aria-hidden="true">
        {% if stats and stats.pulse and stats.pulse.kpi %}
        ğŸ® {{ stats.pulse.kpi.unique_players }} giocatori in competizione
        &nbsp;â€¢&nbsp;
        ğŸ† {{ stats.pulse.kpi.events_total }} tornei disputati
        &nbsp;â€¢&nbsp;
        {% endif %}
        âš”ï¸ 3 TCG: One Piece, PokÃ©mon, Riftbound
        &nbsp;â€¢&nbsp;
        ğŸ”¥ Classifiche sempre aggiornate!
        &nbsp;â€¢&nbsp;
        ğŸ‘€ Chi sarÃ  il prossimo campione?
        &nbsp;â€¢&nbsp;
      </span>
    </div>
  </div>
</div>

<!-- INTRO + COME FUNZIONA (compattati) -->
<div class="mb-5 py-4 bg-light rounded">
  <div class="text-center mb-4">
    <p class="lead text-muted mb-0 px-3">
      TanaLeague traccia i risultati dei tornei <strong>PokÃ©mon</strong>, <strong>One Piece</strong> e <strong>Riftbound</strong>
      de La Tana delle Pulci. Partecipa, accumula punti e scala le classifiche!
    </p>
  </div>
  <div class="row g-3 justify-content-center text-center">
    <div class="col-4 col-md-3">
      <div class="fs-2 mb-1">ğŸ®</div>
      <div class="fw-bold small">Partecipa</div>
    </div>
    <div class="col-4 col-md-3">
      <div class="fs-2 mb-1">â­</div>
      <div class="fw-bold small">Accumula</div>
    </div>
    <div class="col-4 col-md-3">
      <div class="fs-2 mb-1">ğŸ†</div>
      <div class="fw-bold small">Scala</div>
    </div>
  </div>
</div>

<!-- ESPLORA - Navigazione unificata -->
<div class="mb-5">
  <h2 class="text-center h5 text-muted mb-4">Esplora</h2>

  <!-- TCG Row -->
  <div class="row g-3 justify-content-center mb-3">
    <div class="col-4 col-md-3">
      <a href="{{ url_for('classifica', season_id=stats_season_id) }}" class="text-decoration-none">
        <div class="card h-100 border-danger hover-card">
          <div class="card-body text-center py-3">
            <div class="fs-2 mb-1">ğŸ´â€â˜ ï¸</div>
            <h6 class="card-title text-danger mb-0">One Piece</h6>
          </div>
        </div>
      </a>
    </div>
    <div class="col-4 col-md-3">
      {% if pkm_active_season_id %}
      <a href="{{ url_for('classifica', season_id=pkm_active_season_id) }}" class="text-decoration-none">
        <div class="card h-100 border-warning hover-card">
          <div class="card-body text-center py-3">
            <div class="fs-2 mb-1">âš¡</div>
            <h6 class="card-title text-warning mb-0">PokÃ©mon</h6>
          </div>
        </div>
      </a>
      {% else %}
      <div class="card h-100 border-warning opacity-50">
        <div class="card-body text-center py-3">
          <div class="fs-2 mb-1">âš¡</div>
          <h6 class="card-title text-warning mb-0">PokÃ©mon</h6>
        </div>
      </div>
      {% endif %}
    </div>
    <div class="col-4 col-md-3">
      {% if rfb_active_season_id %}
      <a href="{{ url_for('classifica', season_id=rfb_active_season_id) }}" class="text-decoration-none">
        <div class="card h-100 border-info hover-card">
          <div class="card-body text-center py-3">
            <div class="fs-2 mb-1">ğŸŒŒ</div>
            <h6 class="card-title text-info mb-0">Riftbound</h6>
          </div>
        </div>
      </a>
      {% else %}
      <div class="card h-100 border-info opacity-50">
        <div class="card-body text-center py-3">
          <div class="fs-2 mb-1">ğŸŒŒ</div>
          <h6 class="card-title text-info mb-0">Riftbound</h6>
        </div>
      </div>
      {% endif %}
    </div>
  </div>

  <!-- Actions Row -->
  <div class="row g-3 justify-content-center">
    <div class="col-4 col-md-3">
      <a href="{{ url_for('players_list') }}" class="text-decoration-none">
        <div class="card h-100 border-primary hover-card">
          <div class="card-body text-center py-3">
            <div class="fs-2 mb-1">ğŸ”</div>
            <h6 class="card-title text-primary mb-0">Giocatori</h6>
          </div>
        </div>
      </a>
    </div>
    <div class="col-4 col-md-3">
      <a href="{{ url_for('classifiche_page') }}" class="text-decoration-none">
        <div class="card h-100 border-success hover-card">
          <div class="card-body text-center py-3">
            <div class="fs-2 mb-1">ğŸ“Š</div>
            <h6 class="card-title text-success mb-0">Classifiche</h6>
          </div>
        </div>
      </a>
    </div>
    <div class="col-4 col-md-3">
      <a href="{{ url_for('stats', scope=stats_season_id) }}" class="text-decoration-none">
        <div class="card h-100 border-secondary hover-card">
          <div class="card-body text-center py-3">
            <div class="fs-2 mb-1">ğŸ“ˆ</div>
            <h6 class="card-title text-secondary mb-0">Statistiche</h6>
          </div>
        </div>
      </a>
    </div>
  </div>
</div>

<!-- DOMANDE PROVOCATORIE -->
<div class="mb-5">
  <h2 class="text-center h5 text-muted mb-4">Ti stai chiedendo...</h2>
  <div class="row g-3 justify-content-center" id="questions-container">
    <!-- Le domande vengono caricate via JS per essere random -->
  </div>
</div>

<!-- CTA FINALE -->
<div class="text-center py-4">
  <p class="text-muted mb-3">Pronto a competere?</p>
  <a href="{{ url_for('classifiche_page') }}" class="btn btn-primary btn-lg">
    Inizia da qui â†’
  </a>
</div>

<style>
/* Ticker - Stile leggero */
.ticker-container {
  background: linear-gradient(90deg, #f8f9fa 0%, #e9ecef 50%, #f8f9fa 100%);
  border: 1px solid #dee2e6;
  white-space: nowrap;
  padding-left: 70px;
}

.ticker-live-badge {
  position: absolute;
  left: 12px;
  top: 50%;
  transform: translateY(-50%);
  z-index: 10;
}

.ticker-content {
  display: inline-block;
  animation: ticker-scroll 25s linear infinite;
  color: #495057;
}

.ticker-text {
  display: inline-block;
  padding-right: 50px;
}

@keyframes ticker-scroll {
  0% { transform: translateX(0); }
  100% { transform: translateX(-50%); }
}

/* Pulse animation for LIVE badge */
.pulse-animation {
  animation: pulse 1.5s infinite;
}

@keyframes pulse {
  0%, 100% { opacity: 1; }
  50% { opacity: 0.5; }
}

/* Hover effect per le card */
.hover-card {
  transition: transform 0.2s, box-shadow 0.2s;
}

.hover-card:hover {
  transform: translateY(-3px);
  box-shadow: 0 6px 20px rgba(0,0,0,0.12);
}

/* Question cards */
.question-card {
  transition: transform 0.2s, box-shadow 0.2s;
  cursor: pointer;
}

.question-card:hover {
  transform: translateY(-5px);
  box-shadow: 0 8px 25px rgba(0,0,0,0.15);
}
</style>

<script>
// Domande provocatorie con link
const allQuestions = [
  { emoji: "ğŸ†", text: "Chi domina la classifica?", link: "{{ url_for('classifiche_page') }}", color: "warning" },
  { emoji: "ğŸ”¥", text: "Chi ha la striscia vincente piÃ¹ lunga?", link: "{{ url_for('stats', scope=stats_season_id) }}", color: "danger" },
  { emoji: "âš¡", text: "Quanti tornei servono per il podio?", link: "{{ url_for('classifiche_page') }}", color: "warning" },
  { emoji: "ğŸ¯", text: "Sei giÃ  in classifica?", link: "{{ url_for('players_list') }}", color: "primary" },
  { emoji: "ğŸ‘€", text: "C'Ã¨ un nuovo campione?", link: "{{ url_for('classifiche_page') }}", color: "info" },
  { emoji: "ğŸ“Š", text: "Qual Ã¨ il torneo piÃ¹ partecipato?", link: "{{ url_for('stats', scope=stats_season_id) }}", color: "success" },
  { emoji: "ğŸŒŸ", text: "Chi ha piÃ¹ vittorie totali?", link: "{{ url_for('stats', scope=stats_season_id) }}", color: "warning" },
  { emoji: "ğŸ®", text: "Quale TCG ha piÃ¹ giocatori?", link: "{{ url_for('classifiche_page') }}", color: "info" },
  { emoji: "ğŸ¥‡", text: "Chi Ã¨ il re di One Piece?", link: "{{ url_for('classifica', season_id=stats_season_id) }}", color: "danger" },
  {% if pkm_active_season_id %}
  { emoji: "âš¡", text: "Chi comanda su PokÃ©mon?", link: "{{ url_for('classifica', season_id=pkm_active_season_id) }}", color: "warning" },
  {% endif %}
  {% if rfb_active_season_id %}
  { emoji: "ğŸŒŒ", text: "Chi domina Riftbound?", link: "{{ url_for('classifica', season_id=rfb_active_season_id) }}", color: "info" },
  {% endif %}
  { emoji: "ğŸ¤”", text: "Quanto sei forte davvero?", link: "{{ url_for('players_list') }}", color: "secondary" }
];

// Seleziona 3 domande random
function getRandomQuestions(n) {
  const shuffled = [...allQuestions].sort(() => 0.5 - Math.random());
  return shuffled.slice(0, n);
}

// Renderizza le domande
function renderQuestions() {
  const container = document.getElementById('questions-container');
  const questions = getRandomQuestions(3);

  container.innerHTML = questions.map(q => `
    <div class="col-md-4">
      <a href="${q.link}" class="text-decoration-none">
        <div class="card h-100 border-${q.color} question-card">
          <div class="card-body text-center py-4">
            <div class="fs-1 mb-2">${q.emoji}</div>
            <h5 class="card-title text-${q.color}">${q.text}</h5>
            <p class="text-muted small mb-0">Scopri â†’</p>
          </div>
        </div>
      </a>
    </div>
  `).join('');
}

// Inizializza al caricamento pagina
document.addEventListener('DOMContentLoaded', renderQuestions);
</script>

{% endblock %}
