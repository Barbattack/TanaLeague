{% extends "base.html" %}
{% block title %}TanaLeague - Home{% endblock %}
{% block description %}Le leghe de La Tana delle Pulci{% endblock %}

{% block content %}
<!-- HERO -->
<div class="text-center py-5 mb-4">
  <img src="{{ url_for('static', filename='logo.png') }}" alt="La Tana delle Pulci" style="max-width: 200px;" class="mb-3">
  <h1 class="display-4 fw-bold mb-2">TanaLeague</h1>
  <p class="lead text-muted mb-2">Le leghe de La Tana delle Pulci</p>
  <p class="text-muted">Il tuo punto di riferimento per classifiche e statistiche TCG</p>
</div>

<!-- COS'Ãˆ TANALEAGUE -->
<div class="text-center mb-5">
  <div class="row justify-content-center">
    <div class="col-lg-8">
      <h2 class="h4 mb-3">Benvenuto su TanaLeague!</h2>
      <p class="lead text-muted">
        TanaLeague Ã¨ il sistema di classifiche ufficiale de La Tana delle Pulci.
        Tracciamo i risultati dei tornei PokÃ©mon, OnePiece e Riftbound,
        calcoliamo i punteggi e premiamo i migliori giocatori della community!
      </p>
    </div>
  </div>
</div>

<!-- COME FUNZIONA -->
<div class="mb-5">
  <h2 class="text-center h5 text-muted mb-4">Come Funziona</h2>
  <div class="row g-4 justify-content-center">
    <div class="col-md-4 col-lg-3">
      <div class="text-center">
        <div class="fs-1 mb-2">ğŸ®</div>
        <h5 class="fw-bold">1. Partecipa</h5>
        <p class="text-muted small">Gioca ai tornei in negozio</p>
      </div>
    </div>
    <div class="col-md-4 col-lg-3">
      <div class="text-center">
        <div class="fs-1 mb-2">â­</div>
        <h5 class="fw-bold">2. Accumula</h5>
        <p class="text-muted small">Guadagna punti in base ai risultati</p>
      </div>
    </div>
    <div class="col-md-4 col-lg-3">
      <div class="text-center">
        <div class="fs-1 mb-2">ğŸ†</div>
        <h5 class="fw-bold">3. Scala</h5>
        <p class="text-muted small">Sali in classifica e conquista il podio</p>
      </div>
    </div>
  </div>
</div>

<!-- COSA VUOI FARE? -->
<div class="mb-5">
  <h2 class="text-center h5 text-muted mb-4">Cosa Vuoi Fare?</h2>
  <div class="row g-3 justify-content-center">
    <div class="col-md-4">
      <a href="{{ url_for('players_list') }}" class="text-decoration-none">
        <div class="card h-100 border-primary">
          <div class="card-body text-center py-4">
            <div class="fs-1 mb-2">ğŸ”</div>
            <h5 class="card-title text-primary">Cerca un Giocatore</h5>
            <p class="text-muted small mb-0">Trova la scheda di un giocatore e scopri le sue statistiche</p>
          </div>
        </div>
      </a>
    </div>
    <div class="col-md-4">
      <a href="{{ url_for('classifiche_page') }}" class="text-decoration-none">
        <div class="card h-100 border-success">
          <div class="card-body text-center py-4">
            <div class="fs-1 mb-2">ğŸ“Š</div>
            <h5 class="card-title text-success">Vedi le Classifiche</h5>
            <p class="text-muted small mb-0">Consulta le classifiche di tutte le stagioni e tutti i TCG</p>
          </div>
        </div>
      </a>
    </div>
    <div class="col-md-4">
      <a href="{{ url_for('stats', scope=stats_season_id) }}" class="text-decoration-none">
        <div class="card h-100 border-info">
          <div class="card-body text-center py-4">
            <div class="fs-1 mb-2">ğŸ“ˆ</div>
            <h5 class="card-title text-info">Esplora Statistiche</h5>
            <p class="text-muted small mb-0">Scopri record, trend e curiositÃ  sulla community</p>
          </div>
        </div>
      </a>
    </div>
  </div>
</div>

<!-- TCG CARDS -->
<div class="mb-5">
  <h2 class="text-center h5 text-muted mb-4">Scegli il Tuo TCG</h2>
  <div class="row g-3 justify-content-center">
    <div class="col-md-4 col-lg-3">
      <a href="{{ url_for('classifica', season_id=stats_season_id) }}" class="text-decoration-none">
        <div class="card h-100 border-danger">
          <div class="card-body text-center">
            <div class="fs-1 mb-2">ğŸ´â€â˜ ï¸</div>
            <h5 class="card-title text-danger">One Piece</h5>
            <p class="text-muted small mb-0">Vedi classifica stagione attuale â†’</p>
          </div>
        </div>
      </a>
    </div>
    
    <div class="col-md-4 col-lg-3">
      {% if pkm_active_season_id %}
      <a href="{{ url_for('classifica', season_id=pkm_active_season_id) }}" class="text-decoration-none">
        <div class="card h-100 border-warning">
          <div class="card-body text-center">
            <div class="fs-1 mb-2">âš¡</div>
            <h5 class="card-title text-warning">PokÃ©mon</h5>
            <p class="text-muted small mb-0">Vedi classifica stagione attuale â†’</p>
          </div>
        </div>
      </a>
      {% else %}
      <div class="card h-100 border-warning">
        <div class="card-body text-center">
          <div class="fs-1 mb-2">âš¡</div>
          <h5 class="card-title text-warning">PokÃ©mon</h5>
          <p class="text-muted small mb-0">In arrivo...</p>
        </div>
      </div>
      {% endif %}
    </div>

    <div class="col-md-4 col-lg-3">
      {% if rfb_active_season_id %}
      <a href="{{ url_for('classifica', season_id=rfb_active_season_id) }}" class="text-decoration-none">
        <div class="card h-100 border-info">
          <div class="card-body text-center">
            <div class="fs-1 mb-2">ğŸŒŒ</div>
            <h5 class="card-title text-info">Riftbound</h5>
            <p class="text-muted small mb-0">Vedi classifica stagione attuale â†’</p>
          </div>
        </div>
      </a>
      {% else %}
      <div class="card h-100 border-info">
        <div class="card-body text-center">
          <div class="fs-1 mb-2">ğŸŒŒ</div>
          <h5 class="card-title text-info">Riftbound</h5>
          <p class="text-muted small mb-0">In arrivo...</p>
        </div>
      </div>
      {% endif %}
    </div>
  </div>
</div>

<!-- BREAKING NEWS TICKER -->
<div class="mb-5">
  <div class="ticker-container bg-dark text-white py-2 rounded overflow-hidden position-relative">
    <div class="ticker-live-badge">
      <span class="badge bg-danger me-2 pulse-animation">â— LIVE</span>
    </div>
    <div class="ticker-content">
      <span class="ticker-text">
        {% if stats and stats.pulse and stats.pulse.kpi %}
        ğŸ® {{ stats.pulse.kpi.unique_players }} giocatori in competizione
        &nbsp;â€¢&nbsp;
        ğŸ† {{ stats.pulse.kpi.events_total }} tornei disputati questa stagione
        &nbsp;â€¢&nbsp;
        {% endif %}
        âš”ï¸ 3 TCG attivi: One Piece, PokÃ©mon, Riftbound
        &nbsp;â€¢&nbsp;
        ğŸ”¥ Le classifiche si aggiornano dopo ogni torneo!
        &nbsp;â€¢&nbsp;
        ğŸ‘€ Chi sarÃ  il prossimo campione?
        &nbsp;â€¢&nbsp;
      </span>
      <span class="ticker-text" aria-hidden="true">
        {% if stats and stats.pulse and stats.pulse.kpi %}
        ğŸ® {{ stats.pulse.kpi.unique_players }} giocatori in competizione
        &nbsp;â€¢&nbsp;
        ğŸ† {{ stats.pulse.kpi.events_total }} tornei disputati questa stagione
        &nbsp;â€¢&nbsp;
        {% endif %}
        âš”ï¸ 3 TCG attivi: One Piece, PokÃ©mon, Riftbound
        &nbsp;â€¢&nbsp;
        ğŸ”¥ Le classifiche si aggiornano dopo ogni torneo!
        &nbsp;â€¢&nbsp;
        ğŸ‘€ Chi sarÃ  il prossimo campione?
        &nbsp;â€¢&nbsp;
      </span>
    </div>
  </div>
</div>

<!-- DOMANDE PROVOCATORIE -->
<div class="mb-5">
  <h2 class="text-center h5 text-muted mb-4">Ti stai chiedendo...</h2>
  <div class="row g-3 justify-content-center" id="questions-container">
    <!-- Le domande vengono caricate via JS per essere random -->
  </div>
</div>

<style>
/* Ticker Animation */
.ticker-container {
  white-space: nowrap;
  padding-left: 80px;
}

.ticker-live-badge {
  position: absolute;
  left: 10px;
  top: 50%;
  transform: translateY(-50%);
  z-index: 10;
  background: #212529;
  padding-right: 10px;
}

.ticker-content {
  display: inline-block;
  animation: ticker-scroll 30s linear infinite;
}

.ticker-text {
  display: inline-block;
  padding-right: 50px;
}

@keyframes ticker-scroll {
  0% { transform: translateX(0); }
  100% { transform: translateX(-50%); }
}

/* Pulse animation for LIVE badge */
.pulse-animation {
  animation: pulse 1.5s infinite;
}

@keyframes pulse {
  0%, 100% { opacity: 1; }
  50% { opacity: 0.5; }
}

/* Question cards hover effect */
.question-card {
  transition: transform 0.2s, box-shadow 0.2s;
  cursor: pointer;
}

.question-card:hover {
  transform: translateY(-5px);
  box-shadow: 0 8px 25px rgba(0,0,0,0.15);
}
</style>

<script>
// Domande provocatorie con link
const allQuestions = [
  { emoji: "ğŸ†", text: "Chi domina la classifica?", link: "{{ url_for('classifiche_page') }}", color: "warning" },
  { emoji: "ğŸ”¥", text: "Chi ha la striscia vincente piÃ¹ lunga?", link: "{{ url_for('stats', scope=stats_season_id) }}", color: "danger" },
  { emoji: "âš¡", text: "Quanti tornei servono per il podio?", link: "{{ url_for('classifiche_page') }}", color: "warning" },
  { emoji: "ğŸ¯", text: "Sei giÃ  in classifica?", link: "{{ url_for('players_list') }}", color: "primary" },
  { emoji: "ğŸ‘€", text: "C'Ã¨ un nuovo campione?", link: "{{ url_for('classifiche_page') }}", color: "info" },
  { emoji: "ğŸ“Š", text: "Qual Ã¨ il torneo piÃ¹ partecipato?", link: "{{ url_for('stats', scope=stats_season_id) }}", color: "success" },
  { emoji: "ğŸŒŸ", text: "Chi ha piÃ¹ vittorie totali?", link: "{{ url_for('stats', scope=stats_season_id) }}", color: "warning" },
  { emoji: "ğŸ®", text: "Quale TCG ha piÃ¹ giocatori?", link: "{{ url_for('classifiche_page') }}", color: "info" },
  { emoji: "ğŸ¥‡", text: "Chi Ã¨ il re di One Piece?", link: "{{ url_for('classifica', season_id=stats_season_id) }}", color: "danger" },
  {% if pkm_active_season_id %}
  { emoji: "âš¡", text: "Chi comanda su PokÃ©mon?", link: "{{ url_for('classifica', season_id=pkm_active_season_id) }}", color: "warning" },
  {% endif %}
  {% if rfb_active_season_id %}
  { emoji: "ğŸŒŒ", text: "Chi domina Riftbound?", link: "{{ url_for('classifica', season_id=rfb_active_season_id) }}", color: "info" },
  {% endif %}
  { emoji: "ğŸ¤”", text: "Quanto sei forte davvero?", link: "{{ url_for('players_list') }}", color: "secondary" }
];

// Seleziona 3 domande random
function getRandomQuestions(n) {
  const shuffled = [...allQuestions].sort(() => 0.5 - Math.random());
  return shuffled.slice(0, n);
}

// Renderizza le domande
function renderQuestions() {
  const container = document.getElementById('questions-container');
  const questions = getRandomQuestions(3);

  container.innerHTML = questions.map(q => `
    <div class="col-md-4">
      <a href="${q.link}" class="text-decoration-none">
        <div class="card h-100 border-${q.color} question-card">
          <div class="card-body text-center py-4">
            <div class="fs-1 mb-2">${q.emoji}</div>
            <h5 class="card-title text-${q.color}">${q.text}</h5>
            <p class="text-muted small mb-0">Scopri â†’</p>
          </div>
        </div>
      </a>
    </div>
  `).join('');
}

// Inizializza al caricamento pagina
document.addEventListener('DOMContentLoaded', renderQuestions);
</script>

<!-- CTA FINALE -->
<div class="text-center py-5 bg-light rounded">
  <h3 class="mb-3">Pronto a competere?</h3>
  <p class="text-muted mb-4">Partecipa ai tornei de La Tana delle Pulci e scala le classifiche!</p>
  <div class="d-flex justify-content-center gap-3 flex-wrap">
    <a href="{{ url_for('classifiche_page') }}" class="btn btn-primary btn-lg">
      ğŸ“Š Vedi Classifiche
    </a>
    <a href="{{ url_for('players_list') }}" class="btn btn-outline-primary btn-lg">
      ğŸ” Cerca Giocatore
    </a>
  </div>
</div>

{% endblock %}
